<!-- Homepage for UrbanThreadz Project -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UrbanThreadz - Home</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <header class="text-white py-4">
        <div class="container">
            <h1 class="text-center mb-0">Welcome to UrbanThreadz</h1>
        </div>
    </header>
    <nav class="navbar navbar-expand-lg navbar-dark border-bottom">
        <div class="container">
            <div class="w-100 d-flex justify-content-center position-relative">
                <div class="navbar-nav">
                    <a class="nav-link me-4" href="index.html">Homepage</a>
                    <a class="nav-link me-4" href="products.html">Products</a>
                    <a class="nav-link cart-icon" href="cart.html">
                        <i class="bi bi-bag-heart fs-5"></i>
                        <span class="cart-count badge bg-danger rounded-pill ms-1" id="cartCount">0</span>
                    </a>
                </div>
                <div class="navbar-nav position-absolute" style="right: 0;">
                    <a class="nav-link me-3" href="login.html">Login</a>
                    <a class="btn btn-primary signup-btn" href="register.html">Sign Up for Free</a>
                </div>
            </div>
        </div>
    </nav>
    <main>
        <section class="hero-section bg-light py-5">
            <div class="container text-center">
                <h2 class="display-5 fw-bold mb-3">Discover Your Style</h2>
                <p class="lead text-muted">Shop the latest trends in fashion. Quality clothing for everyone.</p>
                <a href="products.html" class="btn btn-primary btn-lg mt-3">Shop Now</a>
            </div>
        </section>

        <!-- Product Categories -->
        <section class="categories-section py-5">
            <div class="container">
                <h2 class="text-center mb-5">Shop by Category</h2>
                <div class="row g-4 justify-content-center">
                    <div class="col-md-4 col-sm-6">
                        <div class="category-card text-center">
                            <div class="category-icon mb-3">
                                <i class="fas fa-tshirt display-4 text-primary"></i>
                            </div>
                            <h5>Tops</h5>
                            <a href="products.html" class="btn btn-outline-primary">Shop Tops</a>
                        </div>
                    </div>
                    <div class="col-md-4 col-sm-6">
                        <div class="category-card text-center">
                            <div class="category-icon mb-3">
                                <i class="fas fa-user-tie display-4 text-primary"></i>
                            </div>
                            <h5>Bottoms</h5>
                            <a href="products.html" class="btn btn-outline-primary">Shop Bottoms</a>
                        </div>
                    </div>
                    <div class="col-md-4 col-sm-6">
                        <div class="category-card text-center">
                            <div class="category-icon mb-3">
                                <i class="bi bi-bag-fill display-4 text-primary"></i>
                            </div>
                            <h5>Accessories</h5>
                            <a href="products.html" class="btn btn-outline-primary">Shop Accessories</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <section class="featured-products py-5">
            <div class="container">
                <h2 class="text-center mb-5">Featured Products</h2>
                <!-- Loading indicator for featured products -->
                <div class="text-center mb-4" id="featuredLoadingIndicator" style="display: none;">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Loading featured products...</span>
                    </div>
                    <p class="mt-2 text-muted">Loading featured products...</p>
                </div>
                <!-- Featured products container -->
                <div class="d-flex flex-wrap justify-content-center gap-3" id="featuredProductsContainer">
                    <!-- Products will be loaded dynamically here -->
                </div>
            </div>
        </section>

        <!-- Why Choose Us Section -->
        <section class="features-section py-5 bg-light">
            <div class="container">
                <h2 class="text-center mb-5">Why Choose UrbanThreadz?</h2>
                <div class="row g-4">
                    <div class="col-md-4 text-center">
                        <div class="feature-item">
                            <i class="bi bi-truck display-4 text-primary mb-3"></i>
                            <h5>Free Shipping</h5>
                            <p class="text-muted">Free shipping on all orders over â‚±2,500</p>
                        </div>
                    </div>
                    <div class="col-md-4 text-center">
                        <div class="feature-item">
                            <i class="bi bi-arrow-clockwise display-4 text-primary mb-3"></i>
                            <h5>Easy Returns</h5>
                            <p class="text-muted">30-day hassle-free returns</p>
                        </div>
                    </div>
                    <div class="col-md-4 text-center">
                        <div class="feature-item">
                            <i class="bi bi-shield-check display-4 text-primary mb-3"></i>
                            <h5>Quality Guarantee</h5>
                            <p class="text-muted">Premium quality materials and craftsmanship</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Customer Reviews -->
        <section class="testimonials-section py-5">
            <div class="container">
                <h2 class="text-center mb-5">What Our Customers Say</h2>
                <div class="row g-4">
                    <div class="col-md-4">
                        <div class="testimonial-card text-center p-4">
                            <div class="stars mb-3">
                                <i class="bi bi-star-fill text-warning"></i>
                                <i class="bi bi-star-fill text-warning"></i>
                                <i class="bi bi-star-fill text-warning"></i>
                                <i class="bi bi-star-fill text-warning"></i>
                                <i class="bi bi-star-fill text-warning"></i>
                            </div>
                            <p class="mb-3">"Amazing quality clothes! The fit is perfect and the customer service is excellent."</p>
                            <h6 class="fw-bold">- Sarah M.</h6>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="testimonial-card text-center p-4">
                            <div class="stars mb-3">
                                <i class="bi bi-star-fill text-warning"></i>
                                <i class="bi bi-star-fill text-warning"></i>
                                <i class="bi bi-star-fill text-warning"></i>
                                <i class="bi bi-star-fill text-warning"></i>
                                <i class="bi bi-star-fill text-warning"></i>
                            </div>
                            <p class="mb-3">"Fast shipping and great prices. Will definitely shop here again!"</p>
                            <h6 class="fw-bold">- Mike R.</h6>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="testimonial-card text-center p-4">
                            <div class="stars mb-3">
                                <i class="bi bi-star-fill text-warning"></i>
                                <i class="bi bi-star-fill text-warning"></i>
                                <i class="bi bi-star-fill text-warning"></i>
                                <i class="bi bi-star-fill text-warning"></i>
                                <i class="bi bi-star-fill text-warning"></i>
                            </div>
                            <p class="mb-3">"Love the style and quality. UrbanThreadz has become my go-to fashion store."</p>
                            <h6 class="fw-bold">- Emma L.</h6>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Newsletter Signup -->
        <section class="newsletter-section py-5 bg-primary text-white">
            <div class="container text-center">
                <h2 class="mb-3">Stay Updated</h2>
                <p class="lead mb-4">Subscribe to our newsletter for exclusive deals and new arrivals</p>
                <div class="row justify-content-center">
                    <div class="col-md-6">
                        <div class="input-group">
                            <input type="email" class="form-control" placeholder="Enter your email address" aria-label="Email address">
                            <button class="btn btn-light" type="button">Subscribe</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- About Us Section -->
        <section class="about-section py-0">
            <div class="container-fluid p-0">
                <div class="row g-0 align-items-stretch min-vh-50">
                    <div class="col-md-6 d-flex align-items-center">
                        <div class="p-5">
                            <h2 class="mb-4">About UrbanThreadz</h2>
                            <p class="lead mb-4">We're passionate about bringing you the latest fashion trends at affordable prices.</p>
                            <p>Founded in 2020, UrbanThreadz has become a trusted name in online fashion retail. We curate high-quality clothing from around the world to bring you unique styles that express your personality.</p>
                            <p>Our mission is to make fashion accessible to everyone, regardless of budget or location. We believe that everyone deserves to look and feel their best.</p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <img src="images/about.webp" class="w-100 h-100" style="object-fit: cover; min-height: 400px;" alt="About UrbanThreadz - Fashion and Style">
                    </div>
                </div>
            </div>
        </section>
    </main>
    <footer class="text-white py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-4">
                    <h5>UrbanThreadz</h5>
                    <p>Your go-to destination for trendy and affordable fashion.</p>
                </div>
                <div class="col-md-4 mb-4">
                    <h5>Quick Links</h5>
                    <ul class="list-unstyled">
                        <li><a href="index.html" class="text-white-50">Home</a></li>
                        <li><a href="products.html" class="text-white-50">Products</a></li>
                        <li><a href="login.html" class="text-white-50">Login</a></li>
                        <li><a href="register.html" class="text-white-50">Register</a></li>
                    </ul>
                </div>
                <div class="col-md-4 mb-4">
                    <h5>Follow Us</h5>
                    <div class="social-links">
                        <a href="#" class="text-white-50 me-3"><i class="bi bi-facebook fs-4"></i></a>
                        <a href="#" class="text-white-50 me-3"><i class="bi bi-instagram fs-4"></i></a>
                        <a href="#" class="text-white-50 me-3"><i class="bi bi-twitter fs-4"></i></a>
                        <a href="#" class="text-white-50"><i class="bi bi-youtube fs-4"></i></a>
                    </div>
                </div>
            </div>
            <hr class="my-4">
            <div class="text-center">
                <p class="mb-0">&copy; 2025 UrbanThreadz. All rights reserved.</p>
            </div>
        </div>
    </footer>
    
    <!-- Add to Cart Success Toast -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3">
        <div id="addToCartToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header">
                <i class="bi bi-check-circle-fill text-success me-2"></i>
                <strong class="me-auto">Success</strong>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body">
                Product added to cart successfully!
            </div>
        </div>
    </div>

    <!-- Product Modal -->
    <div class="modal fade" id="productModal" tabindex="-1" aria-labelledby="productModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="productModalLabel">Product Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="productModalContent">
                    <!-- Product details will be loaded here -->
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/script.js"></script>
    <script>
        // Homepage-specific script for featured products
        document.addEventListener('DOMContentLoaded', function() {
            loadFeaturedProducts();
            updateCartCount(); // Update cart count on page load
        });

        // Load featured products from XML
        function loadFeaturedProducts() {
            const xhr = new XMLHttpRequest();
            
            // Show loading indicator
            document.getElementById('featuredLoadingIndicator').style.display = 'block';
            
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4) {
                    if (xhr.status === 200) {
                        try {
                            const xmlDoc = xhr.responseXML;
                            const products = parseProductsXML(xmlDoc);
                            
                            // Select 4 featured products (first 4 or random selection)
                            const featuredProducts = products.slice(0, 4);
                            displayFeaturedProducts(featuredProducts);
                            
                            // Hide loading indicator
                            document.getElementById('featuredLoadingIndicator').style.display = 'none';
                        } catch (error) {
                            console.error('Error parsing XML for featured products:', error);
                            document.getElementById('featuredLoadingIndicator').style.display = 'none';
                        }
                    } else {
                        console.error('Error loading XML for featured products:', xhr.status);
                        document.getElementById('featuredLoadingIndicator').style.display = 'none';
                    }
                }
            };
            
            xhr.open('GET', 'data/products.xml', true);
            xhr.send();
        }

        // Display featured products on homepage
        function displayFeaturedProducts(products) {
            // Store products globally for modal access
            featuredProducts = products;
            
            const container = document.getElementById('featuredProductsContainer');
            container.innerHTML = '';
            
            products.forEach(product => {
                const productCard = createFeaturedProductCard(product);
                container.appendChild(productCard);
            });
            
            // Add event listeners to featured product buttons
            addFeaturedProductEventListeners();
        }

        // Create featured product card (same as products page)
        function createFeaturedProductCard(product) {
            const col = document.createElement('div');
            col.className = 'col-auto mb-4';
            
            const stockBadge = product.inStock ? 
                '<span class="badge bg-success">In Stock</span>' : 
                '<span class="badge bg-danger">Out of Stock</span>';
            
            col.innerHTML = `
                <div class="card h-100 product-card shadow-sm" style="cursor: pointer; width: 250px;" data-product-id="${product.id}">
                    <div class="position-relative">
                        <img src="${product.image}" class="card-img-top" alt="${product.name}" style="height: 280px; width: 250px; object-fit: cover;">
                        <div class="position-absolute top-0 end-0 m-2">
                            ${stockBadge}
                        </div>
                    </div>
                    <div class="card-body d-flex flex-column" style="width: 250px;">
                        <div class="mb-2">
                            <h5 class="card-title mb-1" style="font-size: 1rem;">${product.name}</h5>
                            <span class="badge bg-secondary">${product.category}</span>
                        </div>
                        
                        <div class="mb-3">
                            <h4 class="text-primary mb-2">â‚±${formatPriceWithCommas(product.price)}</h4>
                        </div>
                        
                        <p class="card-text text-muted mb-4" style="font-size: 0.85rem; line-height: 1.3;">${product.description}</p>
                        
                        <div class="mt-auto">
                            <button class="btn btn-primary w-100 featured-add-to-cart-btn" 
                                    data-product-id="${product.id}" 
                                    data-product-name="${product.name}"
                                    data-product-price="${product.price}"
                                    data-product-image="${product.image}"
                                    ${!product.inStock ? 'disabled' : ''}
                                    onclick="event.stopPropagation();">
                                <i class="bi bi-cart-plus me-1"></i>
                                ${product.inStock ? 'Add to Cart' : 'Out of Stock'}
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            return col;
        }

        // Add event listeners for featured products (with modal functionality)
        function addFeaturedProductEventListeners() {
            // Add to cart buttons
            const addToCartButtons = document.querySelectorAll('.featured-add-to-cart-btn');
            addToCartButtons.forEach(button => {
                button.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const productId = this.dataset.productId;
                    const productName = this.dataset.productName;
                    const productPrice = parseFloat(this.dataset.productPrice);
                    const productImage = this.dataset.productImage;
                    
                    // Check if this product has size/color options
                    const product = featuredProducts.find(p => p.id === productId);
                    const hasOptions = product && (product.sizes.length > 0 || product.colors.length > 0);
                    
                    if (hasOptions) {
                        // If product has options, open modal for selection
                        showFeaturedProductModal(productId);
                    } else {
                        // Add directly to cart if no options
                        addToCart(productId, productName, productPrice, productImage);
                    }
                });
            });

            // Product card click events for modal
            const productCards = document.querySelectorAll('.product-card');
            productCards.forEach(card => {
                card.addEventListener('click', function() {
                    const productId = this.dataset.productId;
                    showFeaturedProductModal(productId);
                });
            });
        }

        // Store featured products globally for modal access
        let featuredProducts = [];

        // Show product modal for featured products
        function showFeaturedProductModal(productId) {
            const product = featuredProducts.find(p => p.id === productId);
            if (!product) return;
            
            // Use the same modal function from script.js but with featured products data
            const modalContent = document.getElementById('productModalContent');
            modalContent.innerHTML = `
                <div class="row">
                    <div class="col-md-6">
                        <img src="${product.image}" class="img-fluid rounded shadow" alt="${product.name}">
                    </div>
                    <div class="col-md-6">
                        <h4 class="fw-bold">${product.name}</h4>
                        <p class="text-muted mb-2">${product.category}</p>
                        <h5 class="text-primary mb-3">â‚±${formatPriceWithCommas(product.price)}</h5>
                        <p class="text-muted mb-4">${product.description}</p>
                        
                        <!-- Size Selection -->
                        <div class="mb-3">
                            <label class="form-label fw-semibold">Size:</label>
                            <div class="d-flex gap-2 flex-wrap" id="sizeOptions">
                                ${product.sizes.map(size => `
                                    <input type="radio" class="btn-check" name="selectedSize" id="size-${size}" value="${size}" autocomplete="off">
                                    <label class="btn btn-outline-secondary" for="size-${size}">${size}</label>
                                `).join('')}
                            </div>
                            <div class="text-danger small mt-1" id="sizeError" style="display: none;">Please select a size</div>
                        </div>
                        
                        <!-- Color Selection -->
                        <div class="mb-4">
                            <label class="form-label fw-semibold">Color:</label>
                            <div class="d-flex gap-2 flex-wrap" id="colorOptions">
                                ${product.colors.map(color => `
                                    <input type="radio" class="btn-check" name="selectedColor" id="color-${color}" value="${color}" autocomplete="off">
                                    <label class="btn btn-outline-secondary" for="color-${color}">${color}</label>
                                `).join('')}
                            </div>
                            <div class="text-danger small mt-1" id="colorError" style="display: none;">Please select a color</div>
                        </div>
                        
                        <!-- Stock Status -->
                        <div class="mb-3">
                            <span class="badge ${product.inStock ? 'bg-success' : 'bg-danger'}">
                                ${product.inStock ? 'In Stock' : 'Out of Stock'}
                            </span>
                        </div>
                        
                        <!-- Add to Cart Button -->
                        <button class="btn btn-primary w-100 btn-lg" 
                                id="modalAddToCart" 
                                data-product-id="${product.id}" 
                                data-product-name="${product.name}"
                                data-product-price="${product.price}"
                                data-product-image="${product.image}"
                                ${!product.inStock ? 'disabled' : ''}>
                            <i class="bi bi-cart-plus me-2"></i>Add to Cart
                        </button>
                    </div>
                </div>
            `;
            
            // Show the modal
            const modal = new bootstrap.Modal(document.getElementById('productModal'));
            modal.show();
            
            // Add event listener for the modal add to cart button
            document.getElementById('modalAddToCart').addEventListener('click', function() {
                const selectedSize = document.querySelector('input[name="selectedSize"]:checked');
                const selectedColor = document.querySelector('input[name="selectedColor"]:checked');
                
                // Reset previous error messages
                document.getElementById('sizeError').style.display = 'none';
                document.getElementById('colorError').style.display = 'none';
                
                // Validate selections
                let hasError = false;
                if (product.sizes.length > 0 && !selectedSize) {
                    document.getElementById('sizeError').style.display = 'block';
                    hasError = true;
                }
                if (product.colors.length > 0 && !selectedColor) {
                    document.getElementById('colorError').style.display = 'block';
                    hasError = true;
                }
                
                if (hasError) return;
                
                // Add to cart with size and color
                const productId = this.dataset.productId;
                const productName = this.dataset.productName;
                const productPrice = parseFloat(this.dataset.productPrice);
                const productImage = this.dataset.productImage;
                
                const size = selectedSize ? selectedSize.value : null;
                const color = selectedColor ? selectedColor.value : null;
                
                addToCartWithOptions(productId, productName, productPrice, productImage, size, color);
                
                // Close modal and show success
                modal.hide();
                showAddToCartToast();
            });
        }
    </script>
</body>
</html>
